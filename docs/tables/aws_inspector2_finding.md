# Table: aws_inspector2_finding

AWS Inspector Findings refer to the security assessment results generated by the AWS Inspector service. AWS Inspector is a security vulnerability assessment service that helps you discover potential security issues and vulnerabilities within your AWS resources.

When you run an assessment with AWS Inspector, it analyzes the target resources such as EC2 instances, ECS clusters, or RDS databases and generates findings that highlight security vulnerabilities, potential misconfigurations, and other security-related issues. These findings provide detailed information about the identified vulnerabilities, including severity levels, affected resources, and recommended remediation steps.

## Examples

### Basic info

```sql
select
  arn,
  description,
  fix_available,
  inspector_score,
  severity,
  finding_account_id
from
  aws_inspector2_finding;
```

### List findings with high severity

```sql
select
  arn,
  source,
  vendor_severity,
  status,
  severity
from
  aws_inspector2_finding
where
  severity = 'HIGH';
```

### Count the number of findings by severity

```sql
select
  severity,
  count(severity)
from
  aws_inspector2_finding
group by
  severity
order by
  severity;
```

### List findings in last 10 days

```sql
select
  title,
  arn,
  severity
from
  aws_inspector2_finding
where
  last_observed_at >= now() - interval '10' day;
```

### List suppressed findings

```sql
select
  arn,
  status,
  type,
  resources,
  vulnerable_packages
from
  aws_inspector2_finding
where
  status = 'SUPPRESSED';
```

### List package vulnerability findings

```sql
select
  arn,
  status,
  type,
  resources,
  vulnerable_packages
from
  aws_inspector2_finding
where
  type = 'PACKAGE_VULNERABILITY';
```

### Get resource details of findings

```sql
select
  f.arn as finding_arn,
  r ->> 'Id' as resource_id,
  r ->> 'Type' as resource_type,
  r ->> 'Details' as resource_details,
  r ->> 'Partition' as partition,
  r ->> 'Tags' as resource_tags
from
  aws_inspector2_finding as f,
  jsonb_array_elements(resources) as r;
```

### Get vulnerable package details of findings

```sql
select
  f.arn,
  f.vulnerability_id,
  v ->> 'Name' as vulnerability_package_name,
  v ->> 'Version' as vulnerability_package_version,
  v ->> 'Arch' as vulnerability_package_arch,
  v ->> 'Epoch' as vulnerability_package_epoch,
  v ->> 'FilePath' as vulnerability_package_file_path,
  v ->> 'FixedInVersion' as vulnerability_package_fixed_in_version,
  v ->> 'PackageManager' as vulnerability_package_package_manager,
  v ->> 'Release' as vulnerability_package_release,
  v ->> 'Remediation' as vulnerability_package_remediation,
  v ->> 'SourceLambdaLayerArn' as source_lambda_layer_arn,
  v ->> 'Name' as source_layer_hash
from
  aws_inspector2_finding as f,
  jsonb_array_elements(vulnerable_packages) as v;
```

### List exploit available findings

```sql
select
  arn,
  finding_account_id,
  first_observed_at,
  fix_available,
  exploit_available
from
  aws_inspector2_finding
where
  exploit_available = 'YES';
```

### List findings that have fixes available through a version update

```sql
select
  arn,
  finding_account_id,
  first_observed_at,
  fix_available,
  exploit_available
from
  aws_inspector2_finding
where
  fix_available = 'YES';
```

### List top 5 findings by inspector score

```sql
select
  arn,
  inspector_score,
  first_observed_at,
  last_observed_at
  inspector_score_details
from
  aws_inspector2_finding
order by
  inspector_score desc;
```

### Get inspector score details of findings

```sql
select
  arn,
  inspector_score_details -> 'AdjustedCvss' ->> 'Score' as adjusted_cvss_score,
  inspector_score_details -> 'AdjustedCvss' ->> 'ScScoreSourceore' as adjusted_cvss_source_score,
  inspector_score_details -> 'AdjustedCvss' ->> 'ScoScoringVectorre' as adjusted_cvss_scoring_vector,
  inspector_score_details -> 'AdjustedCvss' ->> 'Version' as adjusted_cvss_version,
  inspector_score_details -> 'AdjustedCvss' -> 'Adjustments' as adjusted_cvss_adjustments,
  inspector_score_details -> 'AdjustedCvss' ->> 'CvssSource' as adjusted_cvss_cvss_source
from
  aws_inspector2_finding;
```

### Get network reachability details of findings

```sql
select
  arn,
  network_reachability_details -> 'NetworkPath' -> 'Steps' as network_pathsteps,
  network_reachability_details -> 'OpenPortRange' ->> 'Begin' as open_port_range_begin,
  network_reachability_details -> 'OpenPortRange' ->> 'End' as open_port_range_end,
  network_reachability_details -> 'Protocol' as protocol
from
  aws_inspector2_finding;
```

### List findings by resource tags

```sql
select
  arn,
  finding_account_id,
  first_observed_at,
  fix_available,
  exploit_available,
  resource_tags
from
  aws_inspector2_finding
where
  resource_tags = '[{"key": "Name", "value": "Dev"}, {"key": "Name", "value": "Prod"}]';
```

### List findings by vulnerable packages

```sql
select
  arn,
  finding_account_id,
  first_observed_at,
  fix_available,
  exploit_available,
  vulnerable_package
from
  aws_inspector2_finding
where
  vulnerable_package = '[{"architecture": "arc", "epoch": "231321", "name": "myVulere", "release": "v0.2.0", "sourceLambdaLayerArn": "arn:aws:lambda:us-west-2:123456789012:layer:my-layer:1", "sourceLayerHash": "dbasjkhda872", "version": "v0.1.0"}]';
```